<html>

<head>
<title>DIRECT.C</title>
<link rel="stylesheet" href="../style.css">
</head>

<body>
<pre>
                                             <span class='grhilite'>◄</span><a href='_at_L8122.html'>Up</a><span class='grhilite'>►</span> <span class='grhilite'>◄</span><a href='../advisor.hlp/hv.html'>Contents</a><span class='grhilite'>►</span> <span class='grhilite'>◄</span><a href='../advisor.hlp/vx.html'>Index</a><span class='grhilite'>►</span> <span class='grhilite'>◄</span><a href='javascript:history.back();'>Back</a><span class='grhilite'>►</span>
─────Run-Time Library───────────────────────────────────────────────────────
 
/* DIRECT.C illustrates directory functions and miscellaneous file
 * functions including:
 *      _getcwd         _mkdir           _chdir          _rmdir
 *      system          _mktemp          remove          _unlink
 *      _stat
 *
 * See <a href='_at_L80de.html'>NULLFILE.C</a> for an example of _fstat, which is similar to _stat.
 */
 
#include &lt;direct.h&gt;
#include &lt;stdlib.h&gt;
#include &lt;stdio.h&gt;
#include &lt;conio.h&gt;
#include &lt;io.h&gt;
#include &lt;time.h&gt;
#include &lt;sys/types.h&gt;
#include &lt;sys/stat.h&gt;
#define ANSI                /* Delete for UNIX version. */
 
void main()
{
    char cwd[_MAX_DIR];
    char tmpdir[] = "DRXXXXXX";
    struct _stat filestat;
 
    /* Get the current working directory. */
    _getcwd( cwd, _MAX_DIR );
 
    /* Try to make temporary name for directory. */
    if( _mktemp( tmpdir ) == NULL )
    {
        perror( "Can't make temporary directory" );
        exit( 1 );
    }
 
    /* Try to create a new directory, and if successful, change to it. */
    if( !_mkdir( tmpdir ) )
    {
        _chdir( tmpdir );
 
        /* Create and display a file to prove it. */
        system( "echo This is a test. &gt; TEST.TXT" );
        system( "type test.txt" );
 
        /* Display some file statistics. */
        if( !_stat( "TEST.TXT", &amp;filestat ) )
        {
            printf( "File: TEST.TXT\n" );
            printf( "Drive %c:\n", filestat.st_dev + 'A' );
            printf( "Directory: %s\\%s\n", cwd + 2, tmpdir );
            printf( "Size: %ld\n", filestat.st_size );
            printf( "Created: %s", ctime( &amp;filestat.st_atime ) );
        }
        _getch();
 
        /* Delete file, go back to original directory, and remove
         * directory.
         */
#if defined( ANSI )
        remove( "TEST.TXT" );       /* ANSI compatible */
#else
        _unlink( "TEST.TXT" );      /* UNIX compatible */
#endif
        _chdir( cwd );
        _rmdir( tmpdir );
    }
}
                                    -♦-

</pre>
</body>

</html>

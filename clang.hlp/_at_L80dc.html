<html>

<head>
<title>MOVEMEM.C</title>
<link rel="stylesheet" href="../style.css">
</head>

<body>
<pre>
                                             <span class='grhilite'>◄</span><a href='_at_L8122.html'>Up</a><span class='grhilite'>►</span> <span class='grhilite'>◄</span><a href='../advisor.hlp/hv.html'>Contents</a><span class='grhilite'>►</span> <span class='grhilite'>◄</span><a href='../advisor.hlp/vx.html'>Index</a><span class='grhilite'>►</span> <span class='grhilite'>◄</span><a href='javascript:history.back();'>Back</a><span class='grhilite'>►</span>
─────Run-Time Library───────────────────────────────────────────────────────
 
/* MOVEMEM.C illustrates direct memory access using functions:
 *      _movedata        _FP_SEG          _FP_OFF               (DOS-only)
 *
 * Also illustrated:
 *      #pragma pack
 *
 * See <a href='_at_L80b5.html'>COPY2.C</a>, <a href='_at_L80a4.html'>ALARM.C</a>, and <a href='_at_L80f1.html'>SYSCALL.C</a> for more examples of _FP_SEG
 * and _FP_OFF.
 */
 
#include &lt;memory.h&gt;
#include &lt;stdio.h&gt;
#include &lt;dos.h&gt;
 
#pragma pack( 1 )    /* Use pragma to force packing on byte boundaries. */
 
struct LOWMEMVID
{
    char     vidmode;       /* 0x449 */
    unsigned scrwid;        /* 0x44A */
    unsigned scrlen;        /* 0x44C */
    unsigned scroff;        /* 0x44E */
    struct   LOCATE
    {
        unsigned char col;
        unsigned char row;
    } csrpos[8];            /* 0x450 */
    struct   CURSIZE
    {
        unsigned char end;
        unsigned char start;
    } csrsize;              /* 0x460 */
    char     page;          /* 0x462 */
} vid;
struct LOWMEMVID __far *pvid = &amp;vid;
 
void main()
{
    int page;
 
    /* Move system information into uninitialized structure variable. */
    _movedata( 0, 0x449, _FP_SEG( pvid ), _FP_OFF( pvid ), sizeof( vid ) );
 
    printf( "Move data from low memory 0000:0449 to structure at %Fp\n\n",
             (void __far *)&amp;vid );
 
    printf( "Mode:\t\t\t%u\n", vid.vidmode );
    printf( "Page:\t\t\t%u\n", vid.page );
    printf( "Screen width:\t\t%u\n", vid.scrwid );
    printf( "Screen length:\t\t%u\n", vid.scrlen );
    printf( "Cursor size:\t\tstart: %u\tend: %u\n",
             vid.csrsize.start, vid.csrsize.end );
    printf( "Cursor location:\t" );
    for( page = 0; page &lt; 8; page++ )
        printf( "page:\t%u\tcolumn: %u\trow: %u\n\t\t\t",
                page, vid.csrpos[page].col, vid.csrpos[page].row );
}
                                    -♦-

</pre>
</body>

</html>

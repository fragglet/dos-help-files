<html>

<head>
<title>SEEK.C - C Language and Libraries Help</title>
<link rel="stylesheet" href="../style.css">
<link rel="shortcut icon" href="../helpicon.png">
</head>

<body>
<div class="page-heading">
<form action="https://www.google.com/search" method="GET">
<input name="as_q" id="search-box" placeholder="Search">
<input type="hidden" name="as_sitesearch" value="fragglet.github.io/dos-help-files/*">
</form>
C Language and Libraries Help (clang.hlp) (<a href='index.html'>Table of Contents</a>; <a href='TOPIC_LIST.html'>Topic list</a>)</div>
<div class="page-title"> SEEK.C</div>
<pre>                                             <span class='grhilite'>◄</span><a href='x_at_L8122.html'>Up</a><span class='grhilite'>►</span> <span class='grhilite'>◄</span><a href='../advisor.hlp/hv.html'>Contents</a><span class='grhilite'>►</span> <span class='grhilite'>◄</span><a href='../advisor.hlp/vx.html'>Index</a><span class='grhilite'>►</span> <span class='grhilite'>◄</span><a href='javascript:history.back();'>Back</a><span class='grhilite'>►</span>
─────Run-Time Library───────────────────────────────────────────────────────
 
/* SEEK.C illustrates low-level file I/O functions including:
 *      _filelength      _lseek           _tell
 */
 
#include &lt;io.h&gt;
#include &lt;conio.h&gt;
#include &lt;stdio.h&gt;
#include &lt;fcntl.h&gt;          /* _O_ constant definitions */
#include &lt;process.h&gt;
 
void error( char *errmsg );
 
void main()
{
    int handle, ch;
    unsigned count;
    long position, length;
    char buffer[2], fname[80];
 
    /* Get file name and open file. */
    do
    {
        printf( "Enter file name: " );
        gets( fname );
        handle = _open( fname, _O_BINARY | _O_RDONLY );
    } while( handle == -1 );
 
    /* Get and print length. */
    length = _filelength( handle );
    printf( "\nFile length of %s is: %ld\n\n", fname, length );
 
    /* Report the character at a specified position. */
    do
    {
        printf( "Enter integer position less than file length: " );
        scanf( "%ld", &amp;position );
    } while( position &gt; length );
 
    _lseek( handle, position, SEEK_SET );
    if( _read( handle, buffer, 1 ) == -1 )
        error( "Read error" );
    printf( "Character at byte %ld is ASCII %u ('%c')\n\n",
            position, *buffer, *buffer );
 
    /* Search for a specified character and report its position. */
    _lseek( handle, 0L, SEEK_SET);           /* Set to position 0 */
    printf( "Type character to search for: " );
    ch = _getche();
 
    /* Read until character is found. */
    do
    {
        if( (count = _read( handle, buffer, 1 )) == -1 )
            error( "Read error" );
    } while( (*buffer != (char)ch) &amp;&amp; count );
 
    /* Report the current position. */
    position = _tell( handle );
    if( count )
        printf( "\nFirst ASCII %u ('%c') is at byte %ld\n",
                ch, ch, position );
    else
        printf( "\nASCII %u ('%c') not found\n", ch, ch );
    _close( handle );
    exit( 0 );
}
 
void error( char *errmsg )
{
    perror( errmsg );
    exit( 1 );
}
                                    -♦-
</pre>
</body>

</html>

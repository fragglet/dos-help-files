<html>

<head>
<title>_Allocate_Device_CB_Area - Virtual Devices (3.1)</title>
<link rel="stylesheet" href="../style.css">
<link rel="shortcut icon" href="../helpicon.png">
</head>

<body>
<div class="page-heading">
<form action="https://www.google.com/search" method="GET">
<input name="as_q" id="search-box" placeholder="Search">
<input type="hidden" name="as_sitesearch" value="fragglet.github.io/dos-help-files/*">
</form>
Virtual Devices (3.1) (vdag31qh.hlp) (<a href='index.html'>Table of Contents</a>; <a href='TOPIC_LIST.html'>Topic list</a>)</div>
<div class="notice">
  <img src="../warning.png">
  <div class="heading">
    Important Notice
  </div>
  <div class="text">
    The pages on this site contain documentation for very old MS-DOS software,
    purely for historical purposes.

    If you're looking for up-to-date documentation, particularly for programming,
    you should not rely on the information found here, as it will be woefully
    out of date.
  </div>
</div>
<div class="page-title"> _Allocate_Device_CB_Area</div>
<pre>                                                     <span class='grhilite'>◄</span><a href='Miscellaneous_Memory_Management.html'>Up</a><span class='grhilite'>►</span> <span class='grhilite'>◄</span><a href='x_MapPhysToLinear.html'>Next</a><span class='grhilite'>►</span> <span class='grhilite'>◄</span><a href='javascript:history.back();'>Previous</a><span class='grhilite'>►</span>
<b></b><i>────────────────────────────────────────────────────────────────────────────</i>
 
include vmm.inc
 
VMMcall _Allocate_Device_CB_Area, &lt;nBytes, flags&gt;
 
or      eax, eax        ; zero if error
jz      not_allocated
 
mov     [Offset], eax   ; offset from start of control block to new area
 
The _Allocate_Device_CB_Area service allocates an area in the control block
of the current virtual machine for exclusive use by the virtual device.
Virtual devices typically uses this service to allocate space to store data
that is specific to a given virtual machine.
 
This service is only available during initialization.
 
<b>Parameter  Description</b>
────────────────────────────────────────────────────────────────────────────
 
<i>nBytes</i>     Specifies the number of bytes to allocate.
 
<i>flags</i>      Specifies the operation flags. This parameter must be set to 0.
 
<b>Return Value</b>
 
The EAX register contains the offset from the start of the control block to
the new area if the service is successful. Otherwise, EAX contains zero to
indicate an error such as insufficient memory to satisfy the request.
 
<b>Comments</b>
 
If this service returns an error, the virtual device should consider this a
fatal error and respond accordingly.
 
Although this service aligns the new area on a doubleword boundary and
rounds the nBytes parameter up to the next multiple of 4, the virtual device
must not rely on this behavior.
 
The service fills the newly allocated area with zeros. When the system
creates a new virtual machine, it fills all bytes of the control block with
zeros.
 
<b>Uses</b>
 
EAX
 
<b>See Also</b>
 
<b>Control_Block</b>
 
 
                                      ♦
 
</pre>
</body>

</html>

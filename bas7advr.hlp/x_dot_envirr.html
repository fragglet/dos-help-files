<html>

<head>
<title>ENVIRON Statement Details - bas7advr.hlp</title>
<link rel="stylesheet" href="../style.css">
</head>

<body>
<div class="page-heading">
<form action="https://duckduckgo.com/" method="GET">
<input name="q" id="search-box" placeholder="Search">
<input type="hidden" name="sites" value="fragglet.github.io">
</form>
bas7advr.hlp (<a href='TOPIC_LIST.html'>Topic list</a>)</div>
<div class="page-title"> ENVIRON Statement Details</div>
<pre>  <span class='grhilite'>◄</span><a href='unknown#ENVIRON'>Syntax</a><span class='grhilite'>►</span>  <span class='grhilite'>◄</span>Details<span class='grhilite'>►</span>  <span class='grhilite'>◄</span><a href='../bas7ex.hlp/x_dot_envirx.html'>Example</a><span class='grhilite'>►</span>                 <span class='grhilite'>◄</span><a href='unknown#-9996'>Contents</a><span class='grhilite'>►</span>  <span class='grhilite'>◄</span><a href='unknown#-9997'>Index</a><span class='grhilite'>►</span>  <span class='grhilite'>◄</span><a href='javascript:history.back();'>Back</a><span class='grhilite'>►</span>
──────────────────────────────────────────────────────────────────────────────
The ENVIRON statement modifies or adds a parameter in the DOS or OS/2
environment-string table.
 
<b>ENVIRON stringexpression$</b>
    ■ stringexpression$ has one of these forms:
 
        parameterID=text
              or
        parameterID text
 
          parameterID    The name of the environment parameter (such as
                         PATH or PROMPT).  The parameterID must contain
                         all uppercase letters.
          text           The new parameter text.
 
    ■ Everything to the left of the equal sign or space is assumed to be a
      parameter; and everything to the right, text.
    ■ The following example sets a PATH environment variable:
 
        ENVIRON "PATH=C:\CLIENTS;C:\RATES"
 
    ■ If parameterID did not previously exist in the environment-string
      table, it is appended to the end of the table. If parameterID exists
      in the table when the ENVIRON statement is executed, it is deleted
      and the new parameterID is appended to the end of the table.
    ■ If text is a null string ("") or a semicolon (";"), the existing
      parameter is removed from the environment-string table and the
      remaining body of the table is compressed.
 
Important
    ■ You cannot increase the size of the environment-string table when
      using the ENVIRON statement. This means that before you can add a new
      environment variable or increase the size of an existing environment
      variable, you must first delete or decrease the size of existing
      environment variable(s).
    ■ BASIC generates the error message, "Out of memory" when no more space
      can be allocated to the environment-string table. The amount of free
      space in the table is usually quite small.
    ■ The parameterID must contain all uppercase letters. For example:
 
        This statement              Has this effect:
        ═══════════════════════     ═════════════════════════
        ENVIRON "PATH=C:ALES"       Changes the path.
 
        ENVIRON "path=C:ALES"       Does not change the path (it creates
                                    a new environment variable not
                                    usable by the operating system).
 
Usage Notes
    ■ DOS or OS/2 discards the environment-string table modified by this
      function when your program ends. The environment-string table is then
      the same as it was before your program ran.
    ■ You can use this statement to change the PATH parameter for a
      "child" process (a program or command started by a SHELL statement)
      or to pass parameters to a child by creating a new environment
      variable.
    ■ If the parameterID did not previously exist in the environment-
      string table, it is appended to the end of the table. If a
      parameterID exists in the table when the ENVIRON statement is
      executed, it is deleted and the new parameterID is appended to the
      end of the table.
    ■ If the text is a null string ("") or a semi-colon (";"), the
      existing parameter is removed from the environment-string table and
      the remaining body of the table is compressed.
</pre>
</body>

</html>

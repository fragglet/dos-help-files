<html>

<head>
<title>GpiQueryNearestColor (1.2) - gpi12.hlp</title>
<link rel="stylesheet" href="../style.css">
<link rel="shortcut icon" href="../helpicon.png">
</head>

<body>
<div class="page-heading">
<form action="https://www.google.com/search" method="GET">
<input name="as_q" id="search-box" placeholder="Search">
<input type="hidden" name="as_sitesearch" value="fragglet.github.io/dos-help-files/*">
</form>
gpi12.hlp (<a href='index.html'>Table of Contents</a>; <a href='TOPIC_LIST.html'>Topic list</a>)</div>
<div class="page-title"> GpiQueryNearestColor (1.2)</div>
<pre><i><span class='grhilite'>◄</span><a href='mix_mode_functions.html'>Function Group</a><span class='grhilite'>►</span>  <span class='grhilite'>◄</span><a href='unknown#Color and Mix Modes 1.2'>Overview</a><span class='grhilite'>►</span>                          <span class='grhilite'>◄</span><a href='index.html'>Up</a><span class='grhilite'>►</span> <span class='grhilite'>◄</span><a href='GpiQueryNumberSetIds.html'>Next</a><span class='grhilite'>►</span> <span class='grhilite'>◄</span><a href='javascript:history.back();'>Previous</a><span class='grhilite'>►</span></i>
<b></b><i>────────────────────────────────────────────────────────────────────────────</i>
 
#define INCL_GPILOGCOLORTABLE
 
LONG GpiQueryNearestColor(hps, flOptions, lRgbColorIn)
HPS hps;             /* presentation-space handle */
ULONG flClrType;     /* color type                */
LONG lRgbColorIn;    /* RGB color value           */
 
The GpiQueryNearestColor function returns the RGB color value from the
physical palette that most closely matches the RGB color value specified by
the lRgbColorIn parameter. The function uses the physical palette of the
device associated with the given presentation space.
 
If the current logical color table is realizable but has not been realized,
the LCOLOPT_REALIZED option maps the RGB color value as if the logical color
table has been realized. Since realizing a logical color table affects the
contents of the physical palette, the RGB color value returned with this
option may be different than the value returned without the option.
 
<b>Parameter    Description</b>
────────────────────────────────────────────────────────────────────────────
 
<i>hps</i>          Identifies the presentation space.
 
<i>flClrType</i>    Specifies whether the RGB color value is based on realized
             colors. If it is LCOLOPT_REALIZED, the function returns a RGB
             color based on the colors in the physical palette after the
             current logical color table is realized. If the parameter is
             zero, the function returns a RGB color based on the colors in
             the current physical palette.
 
<i>lRgbColorIn</i>  Specifies a RGB color value.
 
<b>Return Value</b>
 
The return value is the nearest available color if the function is
successful or GPI_ALTERROR if an error occurred.
 
<b>Errors</b>
 
Use the WinGetLastError function to retrieve the error value, which may be
one of the following:
 
     PMERR_INV_COLOR_OPTIONS
     PMERR_INV_HPS
     PMERR_INV_RGBCOLOR
     PMERR_PS_BUSY
 
<b>See Also</b>
 
<b>GpiCreateLogColorTable, GpiQueryColorData, GpiQueryRealColors,</b>
<b>GpiQueryRGBColor, WinGetLastError</b>
 
                                      ♦
 
</pre>
</body>

</html>

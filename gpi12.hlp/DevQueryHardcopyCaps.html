<html>

<head>
<title>DevQueryHardcopyCaps (1.2) - gpi12.hlp</title>
<link rel="stylesheet" href="../style.css">
<link rel="shortcut icon" href="../helpicon.png">
</head>

<body>
<div class="page-heading">
<form action="https://www.google.com/search" method="GET">
<input name="as_q" id="search-box" placeholder="Search">
<input type="hidden" name="as_sitesearch" value="fragglet.github.io/dos-help-files/*">
</form>
gpi12.hlp (<a href='index.html'>Table of Contents</a>; <a href='TOPIC_LIST.html'>Topic list</a>)</div>
<div class="notice">
  <img src="../warning.png">
  <div class="heading">
    Important Notice
  </div>
  <div class="text">
    The pages on this site contain documentation for very old MS-DOS software,
    purely for historical purposes.

    If you're looking for up-to-date documentation, particularly for programming,
    you should not rely on the information found here, as it will be woefully
    out of date.
  </div>
</div>
<div class="page-title"> DevQueryHardcopyCaps (1.2)</div>
<pre>                                                      <span class='grhilite'>◄</span><a href='dev.html'>Up</a><span class='grhilite'>►</span> <span class='grhilite'>◄</span><a href='DevCloseDC.html'>Next</a><span class='grhilite'>►</span> <span class='grhilite'>◄</span><a href='javascript:history.back();'>Previous</a><span class='grhilite'>►</span>
<b></b><i>────────────────────────────────────────────────────────────────────────────</i>
 
#define INCL_DEV
 
LONG DevQueryHardcopyCaps(hdc, iStartForm, cForms, phci)
HDC hdc;            /* device-context handle             */
LONG iStartForm;    /* index of forms code to start from */
LONG cForms;        /* number of forms to query          */
PHCINFO phci;       /* pointer to buffer for results     */
 
The DevQueryHardcopyCaps function returns information about the hardcopy
capabilities of a device.
 
You can use the iStartForm and cForms parameters together to enumerate all
available form codes without having to allocate a buffer large enough to
hold information on them all.
 
<b>Parameter   Description</b>
────────────────────────────────────────────────────────────────────────────
 
<i>hdc</i>         Identifies the device context.
 
<i>iStartForm</i>  Specifies the index of the form code from which to start the
            query. The first forms code is specified by the value 0.
 
<i>cForms</i>      Specifies the number of forms to query.
 
<i>phci</i>        Points to the buffer that contains the results of the query. The
            result consists of cForms copies of the HCINFO structure.
 
<b>Return Value</b>
 
If there are five form codes defined and the iStartForm parameter is 2 and
the cForms parameter is 3, a query is performed for form codes 2, 3, and 4
and the result is returned in the buffer pointed to by the phci parameter.
 
The return value, if cForms is zero, is the number of available forms or, if
<i>cForms</i> is nonzero, the number of forms returned. The return value is
DQHC_ERROR if an error occurs.
 
<b>Errors</b>
 
Use the WinGetLastError function to retrieve the error value, which may be
one of the following:
 
     PMERR_INV_FORMS_CODE
     PMERR_INV_HDC
     PMERR_INV_LENGTH_OR_COUNT
 
<b>See Also</b>
 
<b>HCINFO</b>
 
                                      ♦
 
</pre>
</body>

</html>

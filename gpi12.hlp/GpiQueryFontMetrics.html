<html>

<head>
<title>GpiQueryFontMetrics (1.2) - gpi12.hlp</title>
<link rel="stylesheet" href="../style.css">
<link rel="shortcut icon" href="/helpicon.png">
<link rel="icon" href="/helpicon.png">
</head>

<body>
<div class="page-heading">
<form action="https://www.google.com/search" method="GET">
<input name="as_q" id="search-box" placeholder="Search">
<input type="hidden" name="as_sitesearch" value="dos-help.soulsphere.org/*">
</form>
gpi12.hlp (<a href='index.html'>Table of Contents</a>; <a href='TOPIC_LIST.html'>Topic list</a>)</div>
<div class="notice">
  <img src="../warning.png">
  <div class="heading">
    Important Notice
  </div>
  <div class="text">
    The pages on this site contain documentation for very old MS-DOS software,
    purely for historical purposes.

    If you're looking for up-to-date documentation, particularly for programming,
    you should not rely on the information found here, as it will be woefully
    out of date.
  </div>
</div>
<div class="page-title"> GpiQueryFontMetrics (1.2)</div>
<pre><i><span class='grhilite'>◄</span><a href='text_output.html'>Function Group</a><span class='grhilite'>►</span>  <span class='grhilite'>◄</span><a href='../unknown.html#Fonts and Character Primitives 1.2'>Overview</a><span class='grhilite'>►</span>                    </i>      <span class='grhilite'>◄</span><a href='index.html'>Up</a><span class='grhilite'>►</span> <span class='grhilite'>◄</span><a href='GpiQueryFonts.html'>Next</a><span class='grhilite'>►</span> <span class='grhilite'>◄</span><a href='javascript:history.back();'>Previous</a><span class='grhilite'>►</span>
<b></b><i>────────────────────────────────────────────────────────────────────────────</i>
 
#define INCL_GPILCIDS
 
BOOL GpiQueryFontMetrics(hps, cbMetrics, pfm)
HPS hps;             /* presentation-space handle             */
LONG cbMetrics;      /* length of the structure               */
PFONTMETRICS pfm;    /* address of structure for font metrics */
 
The GpiQueryFontMetrics function retrieves the font metrics for the
currently selected logical font. The font metrics describe the typeface
family, name, maximum height, average width, and other information about the
font. All sizes the function retrieves are in world coordinates.
 
<b>Parameter  Description</b>
────────────────────────────────────────────────────────────────────────────
 
<i>hps</i>        Identifies the presentation space.
 
<i>cbMetrics</i>  Specifies the length of the font metrics.
 
<i>pfm      </i>  Points to a FONTMETRICS structure that receives font metrics for
           the logical font.
 
<b>Return Value</b>
 
The return value is GPI_OK if the function is successful or GPI_ERROR if an
error occurred.
 
<b>Errors</b>
 
Use the WinGetLastError function to retrieve the error value, which may be
one of the following:
 
     PMERR_INV_HPS
     PMERR_INV_LENGTH
     PMERR_INV_LENGTH_OR_COUNT
     PMERR_PS_BUSY
 
<b>Example</b>
 
This example uses the GpiQueryFontMetrics function to retrieve the font
metrics for the current font.
 
FONTMETRICS fm;
 
GpiQueryFontMetrics(hps, sizeof(FONTMETRICS), &amp;fm);
 
<b>See Also</b>
 
<b>GpiQueryCp, GpiQueryFonts, GpiQueryKerningPairs, WinGetLastError,</b>
<b>FONTMETRICS</b>
 
                                      ♦
 
</pre>
</body>

</html>

<html>

<head>
<title>Lasttext Macro Example - Programmer's WorkBench</title>
<link rel="stylesheet" href="../style.css">
<link rel="shortcut icon" href="../helpicon.png">
</head>

<body>
<div class="page-heading">
<form action="https://www.google.com/search" method="GET">
<input name="as_q" id="search-box" placeholder="Search">
<input type="hidden" name="as_sitesearch" value="fragglet.github.io/dos-help-files/*">
</form>
Programmer's WorkBench (pwb.hlp) (<a href='index.html'>Table of Contents</a>; <a href='TOPIC_LIST.html'>Topic list</a>)</div>
<div class="page-title"> Lasttext Macro Example</div>
<pre> <span class='grhilite'>◄</span><a href='lasttext.html'>Description</a><span class='grhilite'>►</span>                               <span class='grhilite'>◄</span><a href='pwb_dot_functions.html'>Up</a><span class='grhilite'>►</span> <span class='grhilite'>◄</span><a href='index.html'>Contents</a><span class='grhilite'>►</span> <span class='grhilite'>◄</span><a href='vx.html'>Index</a><span class='grhilite'>►</span> <span class='grhilite'>◄</span><a href='javascript:history.back();'>Back</a><span class='grhilite'>►</span>
─────Programmer's WorkBench─────────────────────────────────────────────────
 
     The OpenInclude macro that follows opens an include file named in
     the next #include directive. The macro demonstrates a technique
     using the Lasttext function to pick up text from the file and
     modify it without modifying the file or the clipboard.
 
     OpenInclude :=  \
          Up Meta Begline Arg Arg "^[ \t]*#[ \t]*include" Psearch -&gt;  \
          Arg Arg "[&lt;&gt;\"]" Psearch -&gt; Right Savecur Psearch -&gt;        \
          Selcur Lasttext Begline "$INCLUDE:" Openfile &lt;n +&gt;          \
          Lastselect Openfile &lt;
 
     In the fourth line, Lasttext pulls the selected filename into the
     Text Argument dialog box. The text argument is modified to prepend
     "$INCLUDE:" before passing it to the Openfile function.
 
     In some macro-programming situations, you don't want to use the
     text immediately. Instead, you need to pick up some text, do some
     other processing, then use the text. In this situation, use the
     phrase:
 
     (make selection) Lasttext Cancel ...
 
     This picks up the text, then cancels the Text Argument dialog box.
     The selected text remains in the Lasttext buffer for later use. To
     reuse the text, call Lasttext again.
                                    -♦-
</pre>
</body>

</html>

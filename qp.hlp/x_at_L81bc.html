<html>

<head>
<title>Val Procedure - qp.hlp</title>
<link rel="stylesheet" href="../style.css">
<link rel="shortcut icon" href="../helpicon.png">
</head>

<body>
<div class="page-heading">
<form action="https://www.google.com/search" method="GET">
<input name="as_q" id="search-box" placeholder="Search">
<input type="hidden" name="as_sitesearch" value="dos-help.soulsphere.org/*">
</form>
qp.hlp (<a href='index.html'>Table of Contents</a>; <a href='TOPIC_LIST.html'>Topic list</a>)</div>
<div class="notice">
  <img src="../warning.png">
  <div class="heading">
    Important Notice
  </div>
  <div class="text">
    The pages on this site contain documentation for very old MS-DOS software,
    purely for historical purposes.

    If you're looking for up-to-date documentation, particularly for programming,
    you should not rely on the information found here, as it will be woefully
    out of date.
  </div>
</div>
<div class="page-title"> Val Procedure</div>
<pre>  <span class='grhilite'>◄</span><a href='Val.html'>Summary</a><span class='grhilite'>►</span> <span class='grhilite'>◄</span>Details<span class='grhilite'>►</span> <span class='grhilite'>◄</span><a href='../unknown.html#sumint.pas'>Example</a><span class='grhilite'>►</span>                                   <span class='grhilite'>◄</span><a href='..//b.html'>Back</a><span class='grhilite'>►</span>
 
  Arguments
 
    source    String representation of the number to be converted
 
    number    Receives the converted value
 
    code      Index of the first invalid character, or zero if none
 
  Description
 
    The Val procedure takes a string input and puts the real or integer
    number value of the string into a real or integer variable. Val
    also sets an error variable.
 
    The source argument contains a string that follows the syntax for
    an integer or real number. An integer can be in signed or unsigned
    decimal or hexadecimal notation. A real number can be expressed in
    scientific (engineering) notation or in ordinary decimal notation,
    with or without a fractional part.
 
    The syntax for an integer is
 
       [{+│-}] { &lt;decimal digits&gt; │ $&lt;hexadecimal digits&gt; }
 
    The syntax for a real number is
 
       [{+│-}] &lt;digits&gt; [.&lt;digits&gt;] [ {E│e} [+│-] &lt;digits&gt; ]
 
    The source may contain leading spaces but must not contain trailing
    spaces.
 
    Val sets code to 0 if successful. If the string does not represent
    a valid syntax for a number, Val sets code to the position in the
    string of the first invalid character.
 
    If the resulting value is out of range for the type of the number
    variable, the range checking state determines the outcome:
 
        When range checking is turned on with {$R+}, the program
        terminates, generating a run-time error message.
 
        When range checking is turned off with {$R-}, the result
        depends on the type of the number argument. A Real or LongInt
        contains an undefined result, and Val sets code to a nonzero
        value. Any other numeric type of number argument contains an
        overflow result, and Val sets code to zero.
 
    Use Val to convert numeric input from the command line or the
    keyboard to an integer or real value to be used in the program.
 
    The Str procedure acts as the inverse of Val, converting a number
    to a string representation.
 
</pre>
</body>

</html>

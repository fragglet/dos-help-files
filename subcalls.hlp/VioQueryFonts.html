<html>

<head>
<title>VioQueryFonts (1.2) - subcalls.hlp</title>
<link rel="stylesheet" href="../style.css">
<link rel="shortcut icon" href="../helpicon.png">
</head>

<body>
<div class="page-heading">
<form action="https://www.google.com/search" method="GET">
<input name="as_q" id="search-box" placeholder="Search">
<input type="hidden" name="as_sitesearch" value="fragglet.github.io/dos-help-files/*">
</form>
subcalls.hlp (<a href='TOPIC_LIST.html'>Topic list</a>)</div>
<div class="page-title"> VioQueryFonts (1.2)</div>
<pre><i><span class='grhilite'>◄</span><a href='unknown#Advanced Vio functions'>Function Group</a><span class='grhilite'>►</span>  <span class='grhilite'>◄</span><a href='unknown#advanced video input and output 1.2'>Overview</a><span class='grhilite'>►</span>                          <span class='grhilite'>◄</span><a href='Vio.html'>Up</a><span class='grhilite'>►</span> <span class='grhilite'>◄</span><a href='VioQuerySetIds.html'>Next</a><span class='grhilite'>►</span> <span class='grhilite'>◄</span><a href='javascript:history.back();'>Previous</a><span class='grhilite'>►</span></i>
<b></b><i>────────────────────────────────────────────────────────────────────────────</i>
 
#define INCL_AVIO
 
USHORT VioQueryFonts(pcbMetrics, pfm, cbMetrics, pcFonts, pszFacename,
    flOptions, hvps)
PLONG pcbMetrics;    /* pointer to variable for structure length */
PFONTMETRICS pfm;    /* pointer to structure for font metrics    */
LONG cbMetrics;      /* length of structure                      */
PLONG pcFonts;       /* pointer to variable for number of fonts  */
PSZ pszFacename;     /* pointer to string for face name          */
ULONG flOptions;     /* enumeration options                      */
HVPS hvps;           /* presentation-space handle                */
 
The VioQueryFonts function retrieves a font-metrics structure (or
structures) that contains characteristics of the fonts that match the
specified face name. These characteristics, or font metrics, are returned
for as many matching fonts as will fit in the structure pointed to by the
<i>pfm</i> parameter.
 
After examining the returned data, the application selects the font most
appropriate for its requirements, and if necessary, forces selection of a
particular font by specifying the lMatch field (as returned in the pfm
parameter) in the FATTRS structure for the VioCreateLogFont function.
 
By specifying zero for the pcFonts parameter and then examining the value
returned, the application determines how many fonts match the specified face
name.
 
All sizes are returned in world coordinates. For more information, see the
<i>Microsoft Operating System/2 Programmer's Reference, Volume 1.</i>
 
<b>Parameter    Description</b>
────────────────────────────────────────────────────────────────────────────
 
<i>pcbMetrics</i>   Points to the variable that receives the length (in bytes) of
             each FONTMETRICS structure. The structure pointed to by the
             pfm parameter must contain the number of bytes given by
             pcFonts x pcMetrics.
 
<i>pfm      </i>    Points to the FONTMETRICS structure that receives the font
             metrics of the specified matching fonts. The format for each
             record is as defined in the GpiQueryFontMetrics function.
 
<i>cbMetrics</i>    Specifies the length (in bytes) of the font-metrics
             structure(s).
 
<i>pcFonts</i>      Points to the variable that receives the number of fonts for
             which the application requires metrics.
 
<i>pszFacename</i>  Points to the null-terminated string that specifies the face
             name.
 
<i>flOptions</i>    Specifies whether to enumerate public or private fonts. This
             parameter may be any combination of the following values:
 
             Value        Meaning
             ───────────────────────────────────────────────────────────────
             VQF_PUBLIC   Enumerate public fonts.
 
             VQF_PRIVATE  Enumerate private fonts.
 
<i>hvps</i>         Identifies the advanced video-input-and-output (AVIO)
             presentation space. This handle must have been created
             previously by using the VioCreatePS function.
 
<b>Return Value</b>
 
The return value is the number of fonts not retrieved. The return value is
-1 if an error occurs.
 
<b>See Also</b>
 
<b>GpiQueryFonts, GpiQueryFontMetrics, VioCreateLogFont, VioCreatePS, FATTRS,</b>
<b>FONTMETRICS</b>
 
                                      ♦
 
</pre>
</body>

</html>

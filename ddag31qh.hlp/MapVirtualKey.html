<html>

<head>
<title>MapVirtualKey - Windows 3.1 Device Drivers</title>
<link rel="stylesheet" href="../style.css">
<link rel="shortcut icon" href="/helpicon.png">
<link rel="icon" href="/helpicon.png">
</head>

<body>
<div class="page-heading">
<form action="https://www.google.com/search" method="GET">
<input name="as_q" id="search-box" placeholder="Search">
<input type="hidden" name="as_sitesearch" value="dos-help.soulsphere.org/*">
</form>
Windows 3.1 Device Drivers (ddag31qh.hlp) (<a href='index.html'>Table of Contents</a>; <a href='TOPIC_LIST.html'>Topic list</a>)</div>
<div class="notice">
  <img src="../warning.png">
  <div class="heading">
    Important Notice
  </div>
  <div class="text">
    The pages on this site contain documentation for very old MS-DOS software,
    purely for historical purposes.

    If you're looking for up-to-date documentation, particularly for programming,
    you should not rely on the information found here, as it will be woefully
    out of date.
  </div>
</div>
<div class="page-title"> MapVirtualKey</div>
<pre>                                                     <span class='grhilite'>◄</span><a href='Keyboard_Driver_Functions.html'>Up</a><span class='grhilite'>►</span> <span class='grhilite'>◄</span><a href='NewTable.html'>Next</a><span class='grhilite'>►</span> <span class='grhilite'>◄</span><a href='javascript:history.back();'>Previous</a><span class='grhilite'>►</span>
<b></b><i>────────────────────────────────────────────────────────────────────────────</i>
 
int MapVirtualKey(wCode, wMapType)
WORD wCode;
WORD wMapType;
 
The MapVirtualKey function maps scan codes to virtual-key codes, and
virtual-key codes to either scan codes or ANSI character values. This
function is intended to be used by the Program Information File (PIF) Editor
and Windows to get information about keyboard mapping.
 
<b>Parameter  Description</b>
────────────────────────────────────────────────────────────────────────────
 
 
<i>wCode</i>      Specifies the input scan code or virtual-key code.
 
<i>wMapType</i>   Specifies which mapping to carry out. This parameter can be one
           of the following values.
 
           Value  Meaning
           ─────────────────────────────────────────────────────────────────
           0      Map virtual key to scan code.
 
           1      Map scan code to virtual key.
 
           2      Map virtual key to ASCII characters.
 
<b>Return Value</b>
 
The return value (in the AX register) is a nonzero scan code or virtual-key
code, if it is successful. Otherwise, the return value is zero if mapping
cannot be performed.
 
<b>Comments</b>
 
The export ordinal for this function is 131.
 
For the first two mappings, the scan code to virtual-key code translation
table is examined to determine the translations. Some valid codes may not be
translated in this table.
 
For the third type of mapping, uppercase letters A through Z are returned
for VK_A through VK_Z. ASCII characters are returned for the top-row numeric
keys VK_0 through VK_9. For punctuation and dead keys in the main part of
the keyboard, the unshifted character will be returned.
 
<b>See Also</b>
 
<b>OemToAnsi, AnsiToOem</b>
 
 
                                      ♦
 
</pre>
</body>

</html>

<html>

<head>
<title>GetEnvironment - Windows 3.1 Device Drivers</title>
<link rel="stylesheet" href="../style.css">
<link rel="shortcut icon" href="../helpicon.png">
</head>

<body>
<div class="page-heading">
<form action="https://www.google.com/search" method="GET">
<input name="as_q" id="search-box" placeholder="Search">
<input type="hidden" name="as_sitesearch" value="fragglet.github.io/dos-help-files/*">
</form>
Windows 3.1 Device Drivers (ddag31qh.hlp) (<a href='index.html'>Table of Contents</a>; <a href='TOPIC_LIST.html'>Topic list</a>)</div>
<div class="page-title"> GetEnvironment</div>
<pre>                                                     <span class='grhilite'>◄</span><a href='Printer-Specific_Graphics_Functions.html'>Up</a><span class='grhilite'>►</span> <span class='grhilite'>◄</span><a href='SetEnvironment.html'>Next</a><span class='grhilite'>►</span> <span class='grhilite'>◄</span><a href='javascript:history.back();'>Previous</a><span class='grhilite'>►</span>
<b></b><i>────────────────────────────────────────────────────────────────────────────</i>
 
int GetEnvironment(lpszPort, lpvEnviron, cbMaxCopy)
LPCSTR lpszPort;        /* address of port name              */
void FAR* lpvEnviron;   /* address of buffer for environment */
UINT cbMaxCopy;         /* maximum number of bytes to copy   */
 
The GetEnvironment function retrieves the current environment that is
associated with the device attached to the specified system port and copies
it into the specified DEVMODE structure. The environment, maintained by
graphics device interface (GDI), contains binary data that GDI uses whenever
a device context is created for the device on the given port.
 
<b>Parameter   Description</b>
────────────────────────────────────────────────────────────────────────────
 
 
<i>lpszPort</i>    Points to the null-terminated string that specifies the name of
            the desired port.
 
<i>lpvEnviron  Points to the DEVM</i>ODE structure that will receive the
            environment.
 
<i>cbMaxCopy</i>   Specifies the maximum number of bytes to be copied to the
            structure.
 
<b>Return Value</b>
 
The return value specifies the number of bytes copied to the DEVMODE
structure pointed to by the lpvEnviron parameter, if the function is
successful. If lpvEnviron is NULL, the return value is the number of bytes
required to hold the environment. It is zero if the environment cannot be
found.
 
<b>Comments</b>
 
The GetEnvironment function is used by drivers only.
 
The GetEnvironment function fails if there is no environment for the given
port.
 
An application can call this function with the lpvEnviron parameter set to
NULL to determine the size of the structure required to hold the
environment. It can then allocate the required number of bytes and call the
<b>GetEnvironment</b> function a second time to retrieve the environment. The first
member in the block pointed to by the lpEnviron parameter should be an atom
that the printer driver has added to the global atom table.
 
<b>See Also</b>
 
<b>SetEnvironment, DEVMODE</b>
 
 
                                      ♦
 
</pre>
</body>

</html>

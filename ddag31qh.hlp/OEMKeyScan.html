<html>

<head>
<title>OEMKeyScan - Windows 3.1 Device Drivers</title>
<link rel="stylesheet" href="../style.css">
<link rel="shortcut icon" href="../helpicon.png">
</head>

<body>
<div class="page-heading">
<form action="https://www.google.com/search" method="GET">
<input name="as_q" id="search-box" placeholder="Search">
<input type="hidden" name="as_sitesearch" value="dos-help.soulsphere.org/*">
</form>
Windows 3.1 Device Drivers (ddag31qh.hlp) (<a href='index.html'>Table of Contents</a>; <a href='TOPIC_LIST.html'>Topic list</a>)</div>
<div class="notice">
  <img src="../warning.png">
  <div class="heading">
    Important Notice
  </div>
  <div class="text">
    The pages on this site contain documentation for very old MS-DOS software,
    purely for historical purposes.

    If you're looking for up-to-date documentation, particularly for programming,
    you should not rely on the information found here, as it will be woefully
    out of date.
  </div>
</div>
<div class="page-title"> OEMKeyScan</div>
<pre>                                                     <span class='grhilite'>◄</span><a href='Keyboard_Driver_Functions.html'>Up</a><span class='grhilite'>►</span> <span class='grhilite'>◄</span><a href='OemToAnsi.html'>Next</a><span class='grhilite'>►</span> <span class='grhilite'>◄</span><a href='javascript:history.back();'>Previous</a><span class='grhilite'>►</span>
<b></b><i>────────────────────────────────────────────────────────────────────────────</i>
 
DWORD OEMKeyScan(wOemChar)
WORD wOemChar;
 
The OEMKeyScan function maps OEM codes (0 through 0FFH) into scan codes and
shift states. This function provides information that enables a program to
send OEM text to another program by simulating keyboard input. Windows, when
running in 386 enhanced mode, uses it specifically for this purpose.
 
<b>Parameter  Description</b>
────────────────────────────────────────────────────────────────────────────
 
 
<i>wOemChar</i>   Specifies the ASCII character.
 
<b>Return Value</b>
 
The return value is the scan code in the AX register and the shift state in
the DX register. If the character is not defined in the tables, the return
value is -1 in both the DX and AX registers.
 
<b>Comments</b>
 
The export ordinal for this function is 128.
 
The bits in the shift state returned in the DX register have the following
meaning.
 
<b>Bit  Value</b>
────────────────────────────────────────────────────────────────────────────
<i>1</i>    1 if the SHIFT key is down; 0 otherwise.
 
<i>2</i>    1 if CTRL and SHIFT is down; 0 otherwise.
 
This function does not provide translations for characters that require the
CTRL+ALT key combination or dead keys.
 
This function calls VkKeyScan.
 
<b>See Also</b>
 
<b>VkKeyScan</b>
 
 
                                      ♦
 
</pre>
</body>

</html>

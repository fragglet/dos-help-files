<html>

<head>
<title>SetEnvironment - Windows 3.1 Device Drivers</title>
<link rel="stylesheet" href="../style.css">
<link rel="shortcut icon" href="../helpicon.png">
</head>

<body>
<div class="page-heading">
<form action="https://www.google.com/search" method="GET">
<input name="as_q" id="search-box" placeholder="Search">
<input type="hidden" name="as_sitesearch" value="fragglet.github.io/dos-help-files/*">
</form>
Windows 3.1 Device Drivers (ddag31qh.hlp) (<a href='index.html'>Table of Contents</a>; <a href='TOPIC_LIST.html'>Topic list</a>)</div>
<div class="page-title"> SetEnvironment</div>
<pre>                                                     <span class='grhilite'>◄</span><a href='Printer-Specific_Graphics_Functions.html'>Up</a><span class='grhilite'>►</span> <span class='grhilite'>◄</span><a href='CreatePQ.html'>Next</a><span class='grhilite'>►</span> <span class='grhilite'>◄</span><a href='javascript:history.back();'>Previous</a><span class='grhilite'>►</span>
<b></b><i>────────────────────────────────────────────────────────────────────────────</i>
 
int SetEnvironment(lpszPort, lpvEnviron, cbMaxCopy)
LPCSTR lpszPort;              /* address of port name                  */
const void FAR* lpvEnviron;   /* address of buffer for new environment */
UINT cbMaxCopy;               /* maximum number of bytes to copy       */
 
The SetEnvironment function copies the contents of the specified buffer into
the environment associated with the device attached to the specified system
port. The environment, maintained by GDI, contains binary data used by GDI
whenever a device context is created for the device on the given port.
 
<b>Parameter   Description</b>
────────────────────────────────────────────────────────────────────────────
 
<i>lpszPort</i>    Points to a null-terminated string that specifies the name of
            the port.
 
<i>lpvEnviron</i>  Points to the buffer that contains the new environment. This
            buffer is in the form of a DEVMODE structure.
 
<i>cbMaxCopy</i>   Specifies the maximum number of bytes to copy to the buffer.
 
<b>Return Value</b>
 
The return value is the number of bytes copied to the environment, if the
function is successful. It is zero if there is an error or 1 if the
environment is deleted.
 
<b>Comments</b>
 
The SetEnvironment function is used by device drivers.
 
The SetEnvironment function deletes any existing environment. If there is no
environment for the given port, SetEnvironment creates one. If the
<i>cbMaxCopy</i> parameter is zero, the existing environment is deleted and not
replaced.
 
The first member of the DEVMODE structure pointed to by the lpvEnviron
parameter must be the same as that passed in the lpDestDevType parameter of
the Enable function. If lpszPort specifies a null port, the dmDeviceName
member is used to locate the environment. The first member in the block
pointed to by the lpEnviron parameter should be an atom that the printer
driver has added to the global atom table.
 
<b>See Also</b>
 
<b>GetEnvironment, DEVMODE</b>
 
 
                                      ♦
 
</pre>
</body>

</html>

<html>

<head>
<title>DosWrite (1.2) - dos12.hlp</title>
<link rel="stylesheet" href="../style.css">
<link rel="shortcut icon" href="../helpicon.png">
</head>

<body>
<div class="page-heading">
<form action="https://www.google.com/search" method="GET">
<input name="as_q" id="search-box" placeholder="Search">
<input type="hidden" name="as_sitesearch" value="fragglet.github.io/dos-help-files/*">
</form>
dos12.hlp (<a href='index.html'>Table of Contents</a>; <a href='TOPIC_LIST.html'>Topic list</a>)</div>
<div class="notice">
  <img src="../warning.png">
  <div class="heading">
    Important Notice
  </div>
  <div class="text">
    The pages on this site contain documentation for very old MS-DOS software,
    purely for historical purposes.

    If you're looking for up-to-date documentation, particularly for programming,
    you should not rely on the information found here, as it will be woefully
    out of date.
  </div>
</div>
<div class="page-title"> DosWrite (1.2)</div>
<pre><i><span class='grhilite'>◄</span><a href='files.html'>Function Group</a><span class='grhilite'>►</span>  <span class='grhilite'>◄</span><a href='../unknown.html#file systems 1.2'>Overview</a><span class='grhilite'>►</span>  <span class='grhilite'>◄</span><a href='x_at_L80e3.html'>Changes</a><span class='grhilite'>►</span>               <span class='grhilite'>◄</span><a href='index.html'>Up</a><span class='grhilite'>►</span> <span class='grhilite'>◄</span><a href='DosWriteAsync.html'>Next</a><span class='grhilite'>►</span> <span class='grhilite'>◄</span><a href='javascript:history.back();'>Previous</a><span class='grhilite'>►</span></i>
<b></b><i>────────────────────────────────────────────────────────────────────────────</i>
 
#define INCL_DOSFILEMGR
 
USHORT DosWrite(hf, pvBuf, cbBuf, pcbBytesWritten)
HFILE hf;                   /* file handle                              */
PVOID pvBuf;                /* pointer to buffer                        */
USHORT cbBuf;               /* number of bytes to write                 */
PUSHORT pcbBytesWritten;    /* pointer to variable receiving byte count */
 
The DosWrite function writes data from a buffer to a file, then copies the
number of bytes written to a variable.
 
The DosWrite function is a family API function.
 
<b>Parameter        Description</b>
────────────────────────────────────────────────────────────────────────────
 
<i>hf</i>               Identifies the file that receives the data. This handle
                 must have been created by using the DosOpen function.
 
<i>pvBuf</i>            Points to the buffer that contains the data to write.
 
<i>cbBuf</i>            Specifies the number of bytes to write.
 
<i>pcbBytesWritten</i>  Points to the variable receiving the number of bytes
                 written.
 
<b>Return Value</b>
 
The return value is zero if the function is successful. Otherwise, it is an
error value, which may be one of the following:
 
     ERROR_ACCESS_DENIED
     ERROR_BROKEN_PIPE
     ERROR_INVALID_HANDLE
     ERROR_LOCK_VIOLATION
     ERROR_NOT_DOS_DISK
     ERROR_WRITE_FAULT
 
<b>Comments</b>
 
The DosWrite function begins to write at the current file-pointer position.
The file-pointer position can be changed by using the DosChgFilePtr
function.
 
If the specified file has been opened using the write-through flag, the
<b>DosWrite</b> function writes data to the disk before returning. Otherwise, the
system collects the data in an internal file buffer and writes the data to
the disk only when the buffer is full.
 
The DosWrite function may write fewer bytes to the file than the number
specified in the cbBuf parameter if there is not enough space on the disk
for all of the requested bytes. The cbBuf parameter can be zero without
causing an error──that is, writing no bytes is acceptable.
 
The efficiency with which DosWrite writes to a disk is improved when cbBuf
is set to a multiple of the disk's bytes-per-sector size. When cbBuf is set
this way, DosWrite writes directly to the disk, without first copying the
data to an internal file buffer. (DosQFSInfo retrieves the bytes-per-sector
value for a disk.)
 
<b>DosWrite</b> can be used to write bytes or messages to a pipe. Each write to a
message pipe writes a message whose size is the length of the write;
<b>DosWrite</b> automatically encodes message lengths in the pipe, so applications
need not encode this information in the buffer being written.
 
Writes in blocking mode always write all requested bytes before returning.
In nonblocking mode, writes return either with all bytes written or none
written; the latter will occur in cases where DosWrite would have to block
in order to complete the request──for example, if there is no room in the
pipe buffer or if the buffer is currently being written to by another
client).
 
An attempt to write to a pipe whose other end has been closed will return
the error ERROR_BROKEN_PIPE.
 
<b>Example</b>
 
This example creates the file abc and calls the DosWrite function to write
the contents of the abBuf buffer to the file:
 
BYTE abBuf[512];
HFILE hf;
USHORT usAction, cbBytesWritten, usError;
usError = DosOpen("abc", &amp;hf, &amp;usAction, 0L, FILE_NORMAL,
    FILE_CREATE,
    OPEN_ACCESS_WRITEONLY | OPEN_SHARE_DENYWRITE, 0L);
if (!usError) {
    DosWrite(hf,                  /* file handle              */
        abBuf,                    /* buffer address           */
        sizeof(abBuf),            /* buffer size              */
        &amp;cbBytesWritten);         /* address of bytes written */
 
<b>See Also</b>
 
<b>DosChgFilePtr, DosOpen, DosQFSInfo, DosRead, DosWriteAsync</b>
 
                                      ♦
 
</pre>
</body>

</html>

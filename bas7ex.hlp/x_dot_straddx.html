<html>

<head>
<title>StringAddress and StringLength Programming Example - bas7ex.hlp</title>
<link rel="stylesheet" href="../style.css">
<link rel="shortcut icon" href="../helpicon.png">
</head>

<body>
<div class="page-heading">
<form action="https://www.google.com/search" method="GET">
<input name="as_q" id="search-box" placeholder="Search">
<input type="hidden" name="as_sitesearch" value="fragglet.github.io/dos-help-files/*">
</form>
bas7ex.hlp (<a href='TOPIC_LIST.html'>Topic list</a>)</div>
<div class="page-title"> StringAddress and StringLength Programming Example</div>
<pre>                       <span class='grhilite'>◄</span>Example<span class='grhilite'>►</span>                 <span class='grhilite'>◄</span><a href='unknown#-9996'>Contents</a><span class='grhilite'>►</span>  <span class='grhilite'>◄</span><a href='unknown#-9997'>Index</a><span class='grhilite'>►</span>  <span class='grhilite'>◄</span><a href='javascript:history.back();'>Back</a><span class='grhilite'>►</span>
──────────────────────────────────────────────────────────────────────────────
'This example uses the StringAddress routine to pass a BASIC string to
'an assembly-language program. The StringLength routine is used to
'determine the length of the string.
 
'Note: To use this program, you must compile the following code and link
'it with the assembled MASM program (shown below in remarks) and the
'appropriate runtime library (BCL71ENR.LIB).
 
DEFINT A-Z
'Create a variable-length string.
Message1$ = "This string was sent to MASM for printing."
'Pass it to MASM to be printed.
CALL PrintMessage1(Message1$)
 
 
'; *************************PrintMessage1************************
';   This MASM procedure prints a string passed to it by BASIC.
'
'            .model      medium, basic       ;Use same model as BASIC
';Define external (BASIC library) procedures
'            extrn   StringAddress: far
'            extrn   StringLength: far
'
'            .code
';Define procedure with one word argument
'PrintMessage1  proc     uses ds,  descriptor
'
'            mov     ax, descriptor          ;Find length of string.
'            push        ax
'            call        StringLength
'            push        ax                  ;Save length on stack.
'
'            mov         ax, descriptor      ;Go find out the
'            push    ax                      ;address of the string
'            CALL    StringAddress           ;data.
'
'            mov         ds, dx              ;Address of string.l.
'            mov         dx, ax
'            mov     bx, 01                  ;Handle of printer.
'            pop     cx                      ;Length of string.
'            mov     ah, 40h                 ;Have DOS print it.
'            int         21h
'            ret
'PrintMessage1   endp
'
'            end
</pre>
</body>

</html>

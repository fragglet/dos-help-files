<html>

<head>
<title>Time Functions Programming Example</title>
<link rel="stylesheet" href="../style.css">
</head>

<body>
<form action="https://duckduckgo.com/" method="GET">
<input name="q" id="search-box" placeholder="Search">
<input type="hidden" name="sites" value="fragglet.github.io">
</form>
<div class="page-title"> Time Functions Programming Example</div>
<pre>                       <span class='grhilite'>◄</span>Example<span class='grhilite'>►</span>                 <span class='grhilite'>◄</span><a href='unknown#-9996'>Contents</a><span class='grhilite'>►</span>  <span class='grhilite'>◄</span><a href='unknown#-9997'>Index</a><span class='grhilite'>►</span>  <span class='grhilite'>◄</span><a href='javascript:history.back();'>Back</a><span class='grhilite'>►</span>
──────────────────────────────────────────────────────────────────────────────
'This example calculates the time between now and midnight tonight.
'The time information is displayed using the TimeValue#, TimeSerial#,
'Hour&amp;, Minute&amp;, and Second&amp; functions.
 
'Note: To run this example you must use a Quick library that includes
'the procedures contained in the date/time/format library files. The
'following $INCLUDE files must also be present.
 
'$INCLUDE: 'DATIM.BI'
'$INCLUDE: 'FORMAT.BI'
 
'Get a time value for midnight tonight - 1 second.
Midnight# = TimeValue#("23:59:59")
 
'Get a time value for right now.
Instant# = Now#
 
'Get the difference in hours, minutes, seconds.
HourDiff% = Hour&amp;(Midnight#) - Hour&amp;(Instant#)
MinuteDiff% = Minute&amp;(Midnight#) - Minute&amp;(Instant#)
 
'Add in the odd second between 23:59:59 and midnight.
SecondDiff% = Second&amp;(Midnight#) - Second&amp;(Instant#) + 1
 
'Adjust so that seconds and minutes are less than 60.
IF SecondDiff% = 60 THEN
        MinuteDiff% = MinuteDiff% + 1
        SecondDiff% = 0
END IF
 
IF MinuteDiff% = 60 THEN
        HourDiff% = HourDiff% + 1
        MinuteDiff% = 0
END IF
 
'Calculate a total of seconds between now and midnight.
TotalMinDiff# = (HourDiff% * 60) + MinuteDiff%
TotalSecDiff# = (TotalMinDiff# * 60) + SecondDiff%
 
'Put the difference back into a standard time format.
TotalDiff# = TimeSerial#(HourDiff%, MinuteDiff%, SecondDiff%)
 
'Display results.
CLS
PRINT "There are a total of"; TotalSecDiff#; "seconds until midnight."
PRINT "That translates to"; HourDiff%; "hours,"; MinuteDiff%;
PRINT "minutes, and"; SecondDiff%; "seconds."
PRINT
PRINT "The difference can also be expressed in standard time notation as:"
PRINT FormatD$(TotalDiff#, "hh:mm:ss")
</pre>
</body>

</html>

<html>

<head>
<title>LOCK...UNLOCK Statement Programming Example - qb45advr.hlp</title>
<link rel="stylesheet" href="../style.css">
<link rel="shortcut icon" href="../helpicon.png">
</head>

<body>
<div class="page-heading">
<form action="https://www.google.com/search" method="GET">
<input name="as_q" id="search-box" placeholder="Search">
<input type="hidden" name="as_sitesearch" value="dos-help.soulsphere.org/*">
</form>
qb45advr.hlp (<a href='TOPIC_LIST.html'>Topic list</a>)</div>
<div class="notice">
  <img src="../warning.png">
  <div class="heading">
    Important Notice
  </div>
  <div class="text">
    The pages on this site contain documentation for very old MS-DOS software,
    purely for historical purposes.

    If you're looking for up-to-date documentation, particularly for programming,
    you should not rely on the information found here, as it will be woefully
    out of date.
  </div>
</div>
<div class="page-title"> LOCK...UNLOCK Statement Programming Example</div>
<pre>  <span class='grhilite'>◄</span><a href='../unknown.html#LOCK'>QuickSCREEN<span class='grhilite'>►</span></a>      <span class='grhilite'>◄</span><a href='x_dot_lockr.html'>Details<span class='grhilite'>►</span></a>     <span class='grhilite'>◄</span>Example<span class='grhilite'>►</span>      <span class='grhilite'>◄</span><a href='../unknown.html#-9996'>Contents<span class='grhilite'>►</span></a>      <span class='grhilite'>◄</span><a href='../unknown.html#-9997'>Index<span class='grhilite'>►</span></a>
──────────────────────────────────────────────────────────────────────────────
<b>LOCK...UNLOCK Statement Programming Examples</b>
 
These example statements show how LOCK and UNLOCK are used in
networked environments, where several processes might need access
to the same file. These examples assume a random-access file.
 
                           ----- Note -----
These examples are incomplete. Do not run them in their current form.
                           ----------------
 
The following statement locks the entire file opened as number 2:
 
  LOCK #2
 
The following statement locks only record 32 in file number 2:
 
  LOCK #2, 32
 
The following statement locks records 1-32 in file number 2:
 
  LOCK #2, TO 32
 
The two UNLOCK statements below unlock the records locked by
the preceding LOCK statements:
 
  LOCK #1, 1 TO 4
  LOCK #1, 5 TO 8
  UNLOCK #1, 1 TO 4
  UNLOCK #1, 5 TO 8
 
The following UNLOCK statement is illegal because the range in an
UNLOCK statement must exactly match the range in the corresponding
LOCK statements (no error is reported, but the statements produce
unpredictable results):
 
  LOCK #1, 1 TO 4
  LOCK #1, 5 TO 8
  UNLOCK #1, 1 TO 8
 
The following program fragment opens a file and allows a user to lock
an individual record before updating the information in that record.
When the user is done, the program unlocks the locked record.
(Unlocking the locked records allows other processes to use the data
in the file.)
 
TYPE AccountRec
   Payer AS STRING * 15
   Address AS STRING * 20
   Place AS STRING * 20
   Owe AS SINGLE
END TYPE
DIM CustRec AS AccountRec
 
OPEN "MONITOR" SHARED AS #1 LEN = LEN(CustRec)
 
DO
   CLS: LOCATE 10,10
   INPUT "Customer Number?   #"; Number%
   ' Lock the current record so another process
   ' doesn't change it while you're using it.
   LOCK #1, Number%
      GET #1, Number%
      LOCATE 11,10: PRINT "Customer: ";CustRec.Payer
      LOCATE 12,10: PRINT "Address:  ";CustRec.Address
      LOCATE 13,10: PRINT "Currently owes: $";CustRec.Owe
      LOCATE 15,10: INPUT "Change (+ or -)", Change!
      CustRec.Owe = CustRec.Owe + Change!
      PUT #1, Number%
   ' Unlock the record.
   UNLOCK #1, Number%
   LOCATE 17,10: INPUT "Update another? ", Continue$
   Update$ = UCASE$(LEFT$(Continue$,1))
LOOP WHILE Update$ = "Y"
 
</pre>
</body>

</html>

<html>

<head>
<title>DOSMEM.C - qc.hlp</title>
<link rel="stylesheet" href="../style.css">
<link rel="shortcut icon" href="../helpicon.png">
</head>

<body>
<div class="page-heading">
<form action="https://duckduckgo.com/" method="GET">
<input name="q" id="search-box" placeholder="Search">
<input type="hidden" name="sites" value="fragglet.github.io">
</form>
qc.hlp (<a href='index.html'>Table of Contents</a>; <a href='TOPIC_LIST.html'>Topic list</a>)</div>
<div class="page-title"> DOSMEM.C</div>
<pre>                                             <span class='grhilite'>◄</span><a href='lib_dot_lst.html'>Up</a><span class='grhilite'>►</span> <span class='grhilite'>◄</span><a href='index.html'>Contents</a><span class='grhilite'>►</span> <span class='grhilite'>◄</span><a href='h_dot_index.html'>Index</a><span class='grhilite'>►</span> <span class='grhilite'>◄</span><a href='javascript:history.back();'>Back</a><span class='grhilite'>►</span>
────────────────────────────────────────────────────────────────────────────
 
/* DOSMEM.C illustrates functions:
 *      _dos_allocmem       _dos_setblock       _dos_freemem
 *
 * See <a href='x_at_L8286.html'>COPY2.C</a> for another example of _dos_allocmem and _dos_freemem.
 */
 
#include &lt;dos.h&gt;
#include &lt;stdio.h&gt;
#include &lt;stdlib.h&gt;
 
void main()
{
    char _far *buf = NULL, _far *p;
    unsigned segbuf, maxbuf, size = 512;
 
    /* Allocate 512-byte buffer. Convert the size to paragraphs.
     * Assign the segment to the buffer. Fill with A's.
     */
    if( _dos_allocmem( size &gt;&gt; 4, &amp;segbuf ) )
        exit( 1 );
    FP_SEG( buf ) = segbuf;
    for( p = buf; p &lt; (buf + size); p++ )
        *p = 'A';
 
    /* Double the allocation. Fill the second half with B's. */
    size *= 2;
    if( _dos_setblock( size &gt;&gt; 4, segbuf, &amp;maxbuf ) )
        exit( 1 );
    FP_SEG( buf ) = segbuf;
    for( p = buf + (size / 2); p &lt; (buf + size); p++ )
        *p = 'B';
    *(--p) = '\0';
 
    printf( "Memory available: %u paragraphs\n", maxbuf );
    printf( "Buffer at %Fp contains:\n%Fs", (int _far *)buf, buf );
 
    /* Free memory */
    exit( !_dos_freemem( segbuf ) );
}
</pre>
</body>

</html>

<html>

<head>
<title>PEEK Function, POKE Statement Details - advr.hlp</title>
<link rel="stylesheet" href="../style.css">
<link rel="shortcut icon" href="../helpicon.png">
</head>

<body>
<div class="page-heading">
<form action="https://www.google.com/search" method="GET">
<input name="as_q" id="search-box" placeholder="Search">
<input type="hidden" name="as_sitesearch" value="fragglet.github.io/dos-help-files/*">
</form>
advr.hlp (<a href='TOPIC_LIST.html'>Topic list</a>)</div>
<div class="page-title"> PEEK Function, POKE Statement Details</div>
<pre>  <span class='grhilite'>◄</span><a href='unknown#PEEK'>Summary</a><span class='grhilite'>►</span>  <span class='grhilite'>◄</span>Details<span class='grhilite'>►</span>  <span class='grhilite'>◄</span><a href='unknown#.defsegx'>Example</a><span class='grhilite'>►</span>                <span class='grhilite'>◄</span><a href='unknown#-9996'>Contents</a><span class='grhilite'>►</span>  <span class='grhilite'>◄</span><a href='unknown#-9997'>Index</a><span class='grhilite'>►</span>  <span class='grhilite'>◄</span><a href='javascript:history.back();'>Back</a><span class='grhilite'>►</span>
──────────────────────────────────────────────────────────────────────────────
 PEEK(address)
 POKE address, byte%
 
 Usage Notes
   ■ Warning: Use POKE carefully. If used incorrectly, it can cause Visual
     Basic or the operating system to fail.
 
   ■ Direct string manipulation with PEEK should be used cautiously, because
     Visual Basic moves string locations during run time. The DEF SEG
     statement should be executed immediately before using the PEEK function.
     See: <span class='grhilite'>◄</span><a href='unknown#seg'>DEF SEG Statement</a><span class='grhilite'>►</span>
 
   ■ Visual Basic moves string locations during run time. Therefore, the
     DEF SEG statement must be executed immediately before using the POKE
     statement.
 
   ■ If address is a single- or double-precision floating-point value or a
     long integer, it is converted to a 2-byte integer.
 
   ■ The PEEK function complements the POKE statement and vice versa.
 
   ■ When using PEEK to return a byte from a far-string array, use the
     SSEG and SADD functions to obtain the current segment and offset.
     For example:
 
         DEF SEG = SSEG(a$)            ' Set the current segment address
                                       ' to the address of a$
         StringOffset = SADD(a$)       ' Determine the string's location
                                       ' within the segment
         PEEK(StringOffset)            ' Return the byte stored at this
                                       ' location
 
   ■ Before using POKE to directly manipulate data stored in far memory,
     use the DEF SEG statement and the SSEG function to set the current
     segment address. For example:
 
         DEF SEG = SSEG(a$)            ' Set the current segment address
                                       ' to the address of a$
         Offset1 = SADD(a$)            ' Determine the string's location
                                       ' within the segment
         POKE Offset1, PEEK(Offset2)   ' Write the byte stored in:
 
   ■ Do not use PEEK or POKE with an expanded-memory array. If you start
     Visual Basic (VBDOS.EXE) with the /Ea switch, any of these arrays may be
     stored in expanded memory:
     • Numeric arrays &lt; 16K in size
     • Fixed-length string arrays &lt; 16K in size
     • User-defined type arrays &lt; 16K in size
     See: <span class='grhilite'>◄</span><a href='unknown#.vbdos.exe'>VBDOS Command-Line Options</a><span class='grhilite'>►</span>
 
   ■ If you want to use PEEK or POKE with an array, first start Visual Basic
     (VBDOS.EXE) without the /Ea switch. Note: Without the /Ea switch, no
     arrays are stored in expanded memory.
 
</pre>
</body>

</html>

<html>

<head>
<title>LOCKING - forlang.hlp</title>
<link rel="stylesheet" href="../style.css">
<link rel="shortcut icon" href="../helpicon.png">
</head>

<body>
<div class="page-heading">
<form action="https://www.google.com/search" method="GET">
<input name="as_q" id="search-box" placeholder="Search">
<input type="hidden" name="as_sitesearch" value="fragglet.github.io/dos-help-files/*">
</form>
forlang.hlp (<a href='index.html'>Table of Contents</a>; <a href='TOPIC_LIST.html'>Topic list</a>)</div>
<div class="page-title"> LOCKING</div>
<pre>                                             <span class='grhilite'>◄</span><a href='iostmnt.html'>Up</a><span class='grhilite'>►</span> <span class='grhilite'>◄</span><a href='../unknown.html#h.hv'>Contents</a><span class='grhilite'>►</span> <span class='grhilite'>◄</span><a href='../unknown.html#h.hvx'>Index</a><span class='grhilite'>►</span> <span class='grhilite'>◄</span><a href='javascript:history.back();'>Back</a><span class='grhilite'>►</span>
─────LOCKING────────────────────────────────────────────────────────────────
 
     Action
 
     Locks direct-access files and records to prevent access by other
     users in a network environment.
 
     Syntax
 
     LOCKING  [UNIT=]unitspec
     [, ERR=errlabel]
     [, IOSTAT=iocheck]
     [, LOCKMODE=lockmode]
     [, REC=rec]
     [, RECORDS=recnum])
 
     If UNIT= is omitted, &lt;unitspec&gt; must be the first parameter.
 
     Parameter       Description
 
     unitspec        An integer expression for the unit to be locked.
                     The file attached to &lt;unitspec&gt; must be open for
                     direct access.
 
     errlabel        The label of an executable statement in the same
                     program unit. An I/O error causes transfer of
                     control to the statement at &lt;errlabel&gt;. If
                     &lt;errlabel&gt; is omitted, the effect of an I/O error
                     is determined by the presence or absence of
                     &lt;iocheck&gt;.
 
     iocheck         An integer variable that returns zero if there is
                     no error, or the error number if an error occurs.
 
     lockmode        A character expression with one of the following
                     values:
 
                     Value       Description
 
                     'NBLCK'     Locks the region for reading
                                 and writing. Default.
 
                     'LOCK'      Locks the region for reading
                                 and writing. Waits for any part of the
                                 region locked by a different process
                                 to become available.
 
                     'NBRLCK'    Locks the region for reading.
 
                     'RLCK'      Locks the region for reading. Waits
                                 for any part of the region locked by
                                 a different process to become available.
 
                     'UNLCK'     Unlocks the specified region.
 
     rec             The number of the first record in a group of records
                     to be locked or unlocked. If omitted, the next
                     record is locked.
 
     recnum          The number of records to be locked. Defaults to one.
 
     Remarks
 
     LOCKING has no effect when used with versions of MS-DOS before
     3.0.
 
     If a parameter is an expression that calls a function, that
     function must not execute an I/O statement or the EOF intrinsic
     function. Calling these functions causes unpredictable results.
                                    -♦-
</pre>
</body>

</html>

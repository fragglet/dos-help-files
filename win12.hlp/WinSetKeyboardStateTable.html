<html>

<head>
<title>WinSetKeyboardStateTable (1.2) - win12.hlp</title>
<link rel="stylesheet" href="../style.css">
<link rel="shortcut icon" href="../helpicon.png">
</head>

<body>
<div class="page-heading">
<form action="https://duckduckgo.com/" method="GET">
<input name="q" id="search-box" placeholder="Search">
<input type="hidden" name="sites" value="fragglet.github.io">
</form>
win12.hlp (<a href='index.html'>Table of Contents</a>; <a href='TOPIC_LIST.html'>Topic list</a>)</div>
<div class="page-title"> WinSetKeyboardStateTable (1.2)</div>
<pre><i><span class='grhilite'>◄</span><a href='Mouse_and_keyboard_input_functions.html'>Function Group</a><span class='grhilite'>►</span>  <span class='grhilite'>◄</span><a href='unknown#Mouse and Keyboard Input 1.2'>Overview</a><span class='grhilite'>►</span>                 </i>         <span class='grhilite'>◄</span><a href='index.html'>Up</a><span class='grhilite'>►</span> <span class='grhilite'>◄</span><a href='WinSetMultWindowPos.html'>Next</a><span class='grhilite'>►</span> <span class='grhilite'>◄</span><a href='javascript:history.back();'>Previous</a><span class='grhilite'>►</span>
<b></b><i>────────────────────────────────────────────────────────────────────────────</i>
 
#define INCL_WININPUT
 
BOOL WinSetKeyboardStateTable(hwndDesktop, pKeyStateTable, fSet)
HWND hwndDesktop;        /* handle of the desktop    */
PBYTE pKeyStateTable;    /* address of the key table */
BOOL fSet;               /* set/copy flag            */
 
The WinSetKeyboardStateTable function gets or sets the keyboard state. This
function does not change the physical state of the keyboard; it changes the
value returned by the WinGetKeyState function, not the value returned by the
<b>WinGetPhysKeyState</b> function.
 
To set the state of a single key you must get the entire table, modify the
individual key, and then set the table from the modified value.
 
<b>Parameter       Description</b>
────────────────────────────────────────────────────────────────────────────
 
<i>hwndDesktop</i>     Identifies the desktop window. This parameter can be
                HWND_DESKTOP or the desktop window handle.
 
<i>pKeyStateTable</i>  Points to a 256-byte table indexed by virtual-key value. For
                any virtual key, the 0x80 bit is set if the key is down and
                cleared if it is up. The 0x01 bit is set if the key is
                toggled (pressed an odd number of times) and cleared
                otherwise.
 
<i>fSet</i>            Specifies whether the keyboard state is set or copied. If
                this parameter is TRUE, the keyboard state is set from
                pKeyStateTable. If this parameter is FALSE, the keyboard
                state is copied to pKeyStateTable.
 
<b>Return Value</b>
 
The return value is TRUE if the function is successful or FALSE if an error
occurs.
 
<b>See Also</b>
 
<b>WinGetKeyState, WinGetPhysKeyState</b>
 
                                      ♦
 
</pre>
</body>

</html>

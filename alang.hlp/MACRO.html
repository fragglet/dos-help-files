<html>

<head>
<title>Macro Block - Assembly Language Help</title>
<link rel="stylesheet" href="../style.css">
</head>

<body>
<div class="page-title"> Macro Block - Assembly Language Help</div>
<pre> <span class='grhilite'>◄</span><a href='x_at_L846f.html'>Example</a><span class='grhilite'>►</span>                                   <span class='grhilite'>◄</span><a href='x_at_L841c.html'>Up</a><span class='grhilite'>►</span> <span class='grhilite'>◄</span><a href='../pwb.hlp/hv.html'>Contents</a><span class='grhilite'>►</span> <span class='grhilite'>◄</span><a href='../pwb.hlp/vx.html'>Index</a><span class='grhilite'>►</span> <span class='grhilite'>◄</span><a href='javascript:history.back();'>Back</a><span class='grhilite'>►</span>
────────────────────────────────────────────────────────────────────────────
 
  Syntax:   name MACRO [parameter[:tag]] [,parameter[:tag]]...]
              [<a href='x_at_L81ba.html'>LOCAL</a> varlist]
              statements
              [EXITM [textitem]]
            ENDM
 
  See also: ENDM, <a href='x_at_L81ba.html'>LOCAL</a>, EXITM, <a href='OLDMACROS.html'>OPTION OLDMACROS</a>, .LISTMACRO,
            FARDATA, PUSHCONTEXT, <a href='x_at_L84af.html'>Using VARARG in Macros</a>,
            <a href='x_at_L800f.html'>MASM 5.1 Compatibility</a>
 
  Description:
 
     Marks the beginning of a macro definition called &lt;name&gt; and takes
     optional parameters. The assembler generates the statements in the
     macro block each time the macro is called in source code. Macro
     procedures and macro functions can be nested up to 40 levels. Text
     macros may be nested up to 20 levels.
 
     Macro procedures can be redefined at any time. The new definition
     affects any subsequent calls to this macro. Macro functions can
     only be redefined, if they have not been called yet.
 
  Example:
 
     mymacro MACRO     value:REQ, reg:=&lt;AX&gt;, options:VARARG
             LOCAL     returnval
             ∙
             ∙
             ∙
               EXITM      returnval
             ENDM
 
     Parameter      Description
 
     name           A unique symbol name. It can appear later in source
                    code, to call the macro.
 
     parameter      A valid symbol name. Each parameter can appear in
                    the statements and is replaced by the corresponding
                    item in the argument list whenever the macro is
                    called.
 
     :tag           Either :REQ, :=default, or :VARARG. :REQ causes an
                    assembler error if the parameter is given a blank
                    argument. :=default causes &lt;parameter&gt; to be
                    assigned &lt;default&gt; if given a null argument.
                    :VARARG allows a variable number of arguments to be
                    passed as a comma-separated list to &lt;parameter&gt;. If
                    :VARARG is used, it must be applied only to the
                    last parameter of the MACRO directive.
 
     statements     Any valid assembler statements.
 
     value          Optional return value for macro function.
                                    -♦-
</pre>
</body>

</html>

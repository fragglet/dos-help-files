<html>

<head>
<title>OLDMACROS│NOOLDMACROS Option - Assembly Language Help</title>
<link rel="stylesheet" href="../style.css">
<link rel="shortcut icon" href="../helpicon.png">
</head>

<body>
<div class="page-heading">
<form action="https://duckduckgo.com/" method="GET">
<input name="q" id="search-box" placeholder="Search">
<input type="hidden" name="sites" value="fragglet.github.io">
</form>
Assembly Language Help (alang.hlp) (<a href='index.html'>Table of Contents</a>; <a href='TOPIC_LIST.html'>Topic list</a>)</div>
<div class="page-title"> OLDMACROS│NOOLDMACROS Option</div>
<pre>                                             <span class='grhilite'>◄</span><a href='OPTION.html'>Up</a><span class='grhilite'>►</span> <span class='grhilite'>◄</span><a href='../pwb.hlp/hv.html'>Contents</a><span class='grhilite'>►</span> <span class='grhilite'>◄</span><a href='../pwb.hlp/vx.html'>Index</a><span class='grhilite'>►</span> <span class='grhilite'>◄</span><a href='javascript:history.back();'>Back</a><span class='grhilite'>►</span>
────────────────────────────────────────────────────────────────────────────
 
  Syntax:   OPTION OLDMACROS
 
            OPTION NOOLDMACROS
 
  See also: MACRO, <a href='x_amp_.html'>Ampersand(&amp;)</a>, <a href='x_at_L800f.html'>MASM 5.1 Compatibility</a>
 
  Description:
 
     The OLDMACROS option enables MASM 5.1-compatible macros and
     parameter substitution. NOOLDMACROS is the default. The OLDMACROS
     option is enabled with the M510 option.
 
     Without OPTION OLDMACROS or OPTION M510, MASM 6.1 changes the behavior of
     macros in several ways. If you want the MASM 5.1 macro behavior, add
     OPTION OLDMACROS or OPTION M510 to your MASM 5.1 code.
 
     MASM 5.1 allows white spaces or commas to separate arguments to macros.
     MASM 6.1 with OPTION NOOLDMACROS (the default) requires commas between
     arguments. For example, in the macro call
 
            MyMacro  var1 var2 var3, var4
 
     OPTION OLDMACROS causes the assembler to treat all four items as separate
     arguments. With OPTION NOOLDMACROS, the assembler treats
 
            var1 var2 var3
 
     as one argument since the items are not separated with commas. To
     convert your macro code, replace spaces between macro arguments with
     a single comma.
 
     The default OPTION NOOLDMACROS causes the assembler to interpret
     ampersands (&amp;) within a macro differently than does MASM 5.1. MASM 5.1
     requires one ampersand for each level of macro nesting. OPTION OLDMACROS
     emulates this behavior.
 
     Without OPTION OLDMACROS, MASM 6.1 removes ampersands only once no
     matter how deeply nested the macro. To update your MASM 5.1 macros,
     follow this simple rule: replace every sequence of ampersands with a
     single ampersand. The only exception is when macro parameters immediately
     precede and follow the ampersand, and both require substitution. In this
     case, use two ampersands.
                                    -♦-
</pre>
</body>

</html>

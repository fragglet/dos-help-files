<html>

<head>
<title>Article Q46980 - vbdpss.hlp</title>
<link rel="stylesheet" href="../style.css">
<link rel="shortcut icon" href="/helpicon.png">
<link rel="icon" href="/helpicon.png">
</head>

<body>
<div class="page-heading">
<form action="https://www.google.com/search" method="GET">
<input name="as_q" id="search-box" placeholder="Search">
<input type="hidden" name="as_sitesearch" value="dos-help.soulsphere.org/*">
</form>
vbdpss.hlp (<a href='index.html'>Table of Contents</a>; <a href='TOPIC_LIST.html'>Topic list</a>)</div>
<div class="notice">
  <img src="../warning.png">
  <div class="heading">
    Important Notice
  </div>
  <div class="text">
    The pages on this site contain documentation for very old MS-DOS software,
    purely for historical purposes.

    If you're looking for up-to-date documentation, particularly for programming,
    you should not rely on the information found here, as it will be woefully
    out of date.
  </div>
</div>
<div class="page-title"> Article Q46980</div>
<pre>                                                 <span class='grhilite'>◄</span><a href='../vbdos.hlp/blang_dot_contents.html'>Contents</a><span class='grhilite'>►</span>  <span class='grhilite'>◄</span><a href='../vbdos.hlp/blang_dot_index.html'>Index</a><span class='grhilite'>►</span>  <span class='grhilite'>◄</span><a href='javascript:history.back();'>Back</a><span class='grhilite'>►</span>
─────────────────────────────────────────────────────────────────────────────
                           <span class='grhilite'>◄</span><a href='index.html'>Knowledge Base Contents</a><span class='grhilite'>►</span>  <span class='grhilite'>◄</span><a href='x_dot_a.html'>Knowledge Base Index</a><span class='grhilite'>►</span>
 
<b> CALL INTERRUPT Example to Get Disk Drive Capacity, Free Space</b> - Q46980
 
 A compiled Basic program can retrieve a disk drive's free space by
 calling MS-DOS Interrupt 21h, with subfunction 36h. This interrupt
 allows a program to obtain a drive's allocation information, which
 provides the drive size and available space. The sizes are returned in
 clusters and must be converted to bytes.
 
 This method is faster than using Basic's SHELL statement to execute
 the MS-DOS CHKDSK (check disk) command.
 
 The information in this article applies to:
 
  - The Standard and Professional Editions of Microsoft Visual Basic
    version 1.0 for MS-DOS
  - Microsoft QuickBasic versions 4.0, 4.0b, and 4.5 for MS-DOS
  - Microsoft Basic Professional Development System (PDS) versions 7.0
    and 7.1 for MS-DOS
  - Microsoft Basic Compiler versions 6.0 and 6.0b for MS-DOS
 
 More Information:
 
 The code sample included below shows how to use the CALL INTERRUPT
 routine to display a drive's used space, available space, and total
 capacity. This example works under MS-DOS in Microsoft Visual Basic
 version 1.0, Microsoft QuickBasic versions 4.0, 4.0b, and 4.5,
 Microsoft Basic Compiler versions 6.0 and 6.0b, and Microsoft Basic
 PDS versions 7.0 and 7.1. For QuickBasic versions 2.0, 2.01, or 3.0
 for MS-DOS, you need to modify the program to use the CALL INT86
 statement instead of CALL INTERRUPT.
 
 Listed below is further information about MS-DOS Interrupt 21h (33
 decimal), with subfunction 36h (54 decimal). This subfunction gets
 disk-drive allocation information, from which the drive's capacity and
 remaining free space can be calculated.
 
 Invoke this function with the following register values:
 
    AH = 54
    DL = drive code (0 = default, 1 = A, 26 = Z)
 
 If the function is successful, it returns the following:
 
    AX = Sectors per cluster
    BX = Number of available clusters
    CX = Bytes per sector
    DX = Clusters per drive
 
 If the function is unsuccessful (drive invalid), it returns the
 following:
 
    AX = FFFFh
 
    <span class='grhilite'>◄</span><a href='x_dot_Q46980EX.html'>See Example</a><span class='grhilite'>►</span>
</pre>
</body>

</html>

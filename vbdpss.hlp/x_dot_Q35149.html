<html>

<head>
<title>Article Q35149 - vbdpss.hlp</title>
<link rel="stylesheet" href="../style.css">
</head>

<body>
<div class="page-heading">
<form action="https://duckduckgo.com/" method="GET">
<input name="q" id="search-box" placeholder="Search">
<input type="hidden" name="sites" value="fragglet.github.io">
</form>
vbdpss.hlp (<a href='index.html'>Table of Contents</a>; <a href='TOPIC_LIST.html'>Topic list</a>)</div>
<div class="page-title"> Article Q35149</div>
<pre>                                                 <span class='grhilite'>◄</span><a href='../vbdos.hlp/blang_dot_contents.html'>Contents</a><span class='grhilite'>►</span>  <span class='grhilite'>◄</span><a href='../vbdos.hlp/blang_dot_index.html'>Index</a><span class='grhilite'>►</span>  <span class='grhilite'>◄</span><a href='javascript:history.back();'>Back</a><span class='grhilite'>►</span>
─────────────────────────────────────────────────────────────────────────────
                           <span class='grhilite'>◄</span><a href='index.html'>Knowledge Base Contents</a><span class='grhilite'>►</span>  <span class='grhilite'>◄</span><a href='x_dot_a.html'>Knowledge Base Index</a><span class='grhilite'>►</span>
 
<b> How to BSAVE and BLOAD Arrays Larger Than 64K in Visual Basic</b> -Q35149
 
 Microsoft Visual Basic version 1.0 for MS-DOS allows the use of "huge"
 dynamic arrays containing more than 64K when you compile your program
 with the /AH option. However, because the BSAVE and BLOAD statements
 use a 2-byte unsigned integer to record the file length, only 64K may
 be contained in a BLOAD/BSAVE file. To save an area of memory larger
 than 64K, you must break the region into blocks (which may overlap),
 each smaller than 65,536 bytes. To BSAVE each block, it is important
 to do a DEF SEG and VARPTR for the start of the region. A "Path/File
 Access Error" may result if those steps are omitted.
 
 More Information:
 
 ' You must invoke Visual Basic 1.0 for MS-DOS with the VBDOS /AH
 ' option.
 '
 ' This code BSAVEs and BLOADs a 128,000 byte array.
 
 OPTION BASE 1
 DEFINT A-Z
 '$DYNAMIC
 DIM nums(32000, 2)
 FOR k = 1 TO 32000
         FOR l = 1 TO 2
                 nums(k, l) = k + l
         NEXT l
 NEXT k
 DEF SEG = VARSEG(nums(1, 1))
 BSAVE "star52a.sav", VARPTR(nums(1, 1)), 64000
 DEF SEG = VARSEG(nums(16000, 1))
 BSAVE "star52b.sav", VARPTR(nums(16000, 1)), 64000
 FOR k = 1 TO 32000
         FOR l = 1 TO 2
                 nums(k, l) = 0
         NEXT l
 NEXT k
 BLOAD "star52a.sav" ' Uses segment, offset recorded
 BLOAD "star52b.sav" ' in the BSAVEd file.
 PRINT nums(200, 2); " is 200+2"
 PRINT nums(25000, 1); " is 25000+1"
</pre>
</body>

</html>

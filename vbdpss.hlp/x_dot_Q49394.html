<html>

<head>
<title>Article Q49394 - vbdpss.hlp</title>
<link rel="stylesheet" href="../style.css">
<link rel="shortcut icon" href="../helpicon.png">
</head>

<body>
<div class="page-heading">
<form action="https://www.google.com/search" method="GET">
<input name="as_q" id="search-box" placeholder="Search">
<input type="hidden" name="as_sitesearch" value="fragglet.github.io/dos-help-files/*">
</form>
vbdpss.hlp (<a href='index.html'>Table of Contents</a>; <a href='TOPIC_LIST.html'>Topic list</a>)</div>
<div class="page-title"> Article Q49394</div>
<pre>                                                 <span class='grhilite'>◄</span><a href='../vbdos.hlp/blang_dot_contents.html'>Contents</a><span class='grhilite'>►</span>  <span class='grhilite'>◄</span><a href='../vbdos.hlp/blang_dot_index.html'>Index</a><span class='grhilite'>►</span>  <span class='grhilite'>◄</span><a href='javascript:history.back();'>Back</a><span class='grhilite'>►</span>
─────────────────────────────────────────────────────────────────────────────
                           <span class='grhilite'>◄</span><a href='index.html'>Knowledge Base Contents</a><span class='grhilite'>►</span>  <span class='grhilite'>◄</span><a href='x_dot_a.html'>Knowledge Base Index</a><span class='grhilite'>►</span>
 
<b> Example of Passing User-Defined Type from MASM to Basic</b> - Q49394
 
 The two programs below demonstrate how Microsoft assembly language can
 pass a user-defined type to Basic.
 
 More Information:
 
 The following Basic program is BUTYPE.BAS, which receives a
<b> user-defined type from an assembly language program and prints it out.</b>
 
 Code Example
 ------------
 
 DEFINT A-Z
 DECLARE SUB MasmSub
 
 TYPE mixed
    i AS INTEGER
    lng AS LONG
    s AS SINGLE
    d AS DOUBLE
    fx AS STRING * 19
 END TYPE
 
 DIM dummy AS mixed
 
 CLS
 PRINT "Calling assembly routine which will fill the";
 PRINT " user-defined type."
 CALL MasmSub
 END
 
 SUB BASICSub (dummy AS mixed)
 
    PRINT "Values in user-defined type:"
    PRINT
    PRINT "Integer: ", dummy.i
    PRINT "Long: ", dummy.lng
    PRINT "Single: ", dummy.s
    PRINT "Double: ", dummy.d
    PRINT "fixed-length String: ", dummy.fx
 
 END SUB
 
 The following program is AUTYPE.ASM, which builds a user-defined type
<b> and passes it to Basic:</b>
 
 .MODEL MEDIUM
         usrdefType STRUC
                    iAsm  DW 10
                    lAsm  DD 43210
                    sAsm  DD 32.10
                    dAsm  DQ 12345.67
                    fxAsm DB 'Fixed-length string'
         usrdefType ENDS
         EXTRN BASICSub:PROC
 .DATA
         BASICRec usrdefType &lt;&gt;
 .CODE
 
         PUBLIC MasmSub
 MasmSub PROC                     ; No stack frame is needed
                                  ;   because no arguments are
                                  ;   passed to assembly.
         mov ax, OFFSET BASICRec  ; Get address of structure.
         push ax                  ; Pass it as argument to Basic.
         CALL BASICSUb
         ret
 MasmSub ENDP
         END
 
 To demonstrate these programs from an .EXE program, compile and link
<b> as follows:</b>
 
    BC BUTYPE.BAS;
    MASM AUTYPE.ASM;
    LINK BUTYPE AUTYPE;
 
 BUTYPE.EXE produces the following output:
 
      Integer:   10
      Long:      43210
      Single:    32.1
      Double:    12345.67
      fixed-length String:  Fixed-length string
</pre>
</body>

</html>

<html>

<head>
<title>Article Q39252 - vbdpss.hlp</title>
<link rel="stylesheet" href="../style.css">
<link rel="shortcut icon" href="../helpicon.png">
</head>

<body>
<div class="page-heading">
<form action="https://www.google.com/search" method="GET">
<input name="as_q" id="search-box" placeholder="Search">
<input type="hidden" name="as_sitesearch" value="fragglet.github.io/dos-help-files/*">
</form>
vbdpss.hlp (<a href='index.html'>Table of Contents</a>; <a href='TOPIC_LIST.html'>Topic list</a>)</div>
<div class="page-title"> Article Q39252</div>
<pre>                                                 <span class='grhilite'>◄</span><a href='../vbdos.hlp/blang_dot_contents.html'>Contents</a><span class='grhilite'>►</span>  <span class='grhilite'>◄</span><a href='../vbdos.hlp/blang_dot_index.html'>Index</a><span class='grhilite'>►</span>  <span class='grhilite'>◄</span><a href='javascript:history.back();'>Back</a><span class='grhilite'>►</span>
─────────────────────────────────────────────────────────────────────────────
                           <span class='grhilite'>◄</span><a href='index.html'>Knowledge Base Contents</a><span class='grhilite'>►</span>  <span class='grhilite'>◄</span><a href='x_dot_a.html'>Knowledge Base Index</a><span class='grhilite'>►</span>
 
<b> ON KEY Trapping CTRL, SHIFT, CAPS LOCK, NUM LOCK Combinations</b> - Q39252
 
 Pressing any key in combination with CTRL, SHIFT, ALT, CAPS LOCK, or
 NUM LOCK changes the keyboard scan code. To trap combinations of keys,
 the KEY statement requires adding together the values of the keyboard
 flags as shown in the code example listed below.
 
 The following is a code example:
 
 ' To try this example in VBDOS.EXE:
 ' 1. From the File menu, choose New Project.
 ' 2. Copy the code example to the Code window.
 ' 3. Press F5 to run the program.
 
    CONST alt = &amp;H8
    CONST nodal = &amp;H0
    CONST leftshift = &amp;H1
    CONST rightshift = &amp;H2
    CONST ctrl = &amp;H4
    CONST numlock = &amp;H20
    CONST capslock = &amp;H40
    CONST extendedkeyboard = &amp;H80
    CONST left = &amp;H4B
    CONST right = &amp;H4D
    CONST up = &amp;H48
    CONST down = &amp;H50
    CONST C = &amp;H2E
    CONST scrolllock = &amp;H46
 
    KEY 15, CHR$(extendedkeyboard + numlock) + CHR$(left)
    KEY 16, CHR$(extendedkeyboard + numlock) + CHR$(right)
    KEY 17, CHR$(extendedkeyboard + numlock) + CHR$(up)
    KEY 18, CHR$(extendedkeyboard + numlock) + CHR$(down)
    KEY 19, CHR$(ctrl + capslock) + CHR$(C)
    KEY 20, CHR$(extendedkeyboard + ctrl + numlock) + CHR$(scrolllock)
 
    ON KEY(15) GOSUB left
    ON KEY(16) GOSUB right
    ON KEY(17) GOSUB up
    ON KEY(18) GOSUB down
    ON KEY(19) GOSUB break
    ON KEY(20) GOSUB break
 
    KEY(15) ON
    KEY(16) ON
    KEY(17) ON
    KEY(18) ON
    KEY(19) ON
    KEY(20) ON
 
    WHILE UCASE$(INKEY$) &lt;&gt; UCASE$("q")
    WEND
    END
 
    left:
     PRINT "left"
    RETURN
 
    right:
     PRINT "right"
    RETURN
 
    up:
     PRINT "up"
    RETURN
 
    down:
     PRINT "down"
    RETURN
 
    break:
     PRINT "break"
    RETURN
</pre>
</body>

</html>
